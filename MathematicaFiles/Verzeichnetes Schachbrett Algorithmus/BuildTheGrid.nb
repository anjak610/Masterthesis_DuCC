(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58731,       1264]
NotebookOptionsPosition[     58425,       1250]
NotebookOutlinePosition[     58767,       1265]
CellTagsIndexPosition[     58724,       1262]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindNeighbours", "[", 
     RowBox[{
     "IList_", ",", "JList_", ",", "Start_", ",", " ", "nextI_", ",", 
      "nextJ_", ",", "ConvexHull_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SortedPointsKeys", "=", 
         RowBox[{"<|", "|>"}]}], ",", 
        RowBox[{"SortedPoints", "=", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"SaftyList", "=", 
         RowBox[{"{", "}"}]}], ","}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<\n\nDetect I and J rows of \
Points______________________________________________________________ \n\n\
\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"StartPoint", " ", "=", " ", "Start"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StartPointI", "=", " ", "Start"}], ";", "\[IndentingNewLine]", 
       RowBox[{"StartPointJ", "=", " ", "Start"}], ";", "\[IndentingNewLine]", 
       RowBox[{"NextPointI", " ", "=", " ", "nextI"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NextPointJ", " ", "=", " ", "nextJ"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Start = \>\"", ",", "Start"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\< nextI = \>\"", ",", " ", "nextI"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<nextJ = \>\"", ",", "nextJ"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IDirStart", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"nextI", "[", "CoordI", "]"}], "-", 
           RowBox[{"Start", "[", "CoordI", "]"}]}], ",", 
          RowBox[{
           RowBox[{"nextI", "[", "CoordJ", "]"}], "-", " ", 
           RowBox[{"Start", "[", "CoordJ", "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"JDirStart", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"nextJ", "[", "CoordI", "]"}], "-", 
           RowBox[{"Start", "[", "CoordI", "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"nextJ", "[", "CoordJ", "]"}], "-", 
           RowBox[{"Start", "[", "CoordJ", "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<IDir = \>\"", ",", " ", "IDirStart"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<JDir = \>\"", ",", " ", "JDirStart"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"StartProportionI", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"Start", "[", "CoordI", "]"}], "-", 
               RowBox[{"nextI", "[", "CoordI", "]"}]}], ")"}], "+", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"Start", "[", "CoordJ", "]"}], "-", 
               RowBox[{"nextI", "[", "CoordJ", "]"}]}], ")"}]}], "]"}], "]"}],
           ")"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IDirStart", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"IDirStart", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"StartProportionJ", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"Start", "[", "CoordI", "]"}], "-", 
               RowBox[{"nextJ", "[", "CoordI", "]"}]}], ")"}], "+", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"Start", "[", "CoordJ", "]"}], "-", 
               RowBox[{"nextJ", "[", "CoordJ", "]"}]}], ")"}]}], "]"}], "]"}],
           ")"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"JDirStart", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"JDirStart", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"StartDistanceI", " ", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IDirStart", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"IDirStart", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"StartDistanceJ", " ", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"JDirStart", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"JDirStart", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"StartPoint", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NeighbourJ", "\[Rule]", " ", "1"}], ",", " ", 
           RowBox[{"NeighbourI", " ", "\[Rule]", "1"}]}], "}"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"NextPointI", " ", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"NeighbourJ", " ", "\[Rule]", "1"}], ",", 
           RowBox[{"NeighbourI", "\[Rule]", " ", "2"}]}], "}"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"NextPointJ", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"NeighbourJ", " ", "\[Rule]", "2"}], ",", 
           RowBox[{"NeighbourI", "\[Rule]", " ", "1"}]}], "}"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"SortedPoints", ",", 
         RowBox[{"{", 
          RowBox[{"StartPoint", ",", "NextPointI", ",", "NextPointJ"}], 
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"CheckPoints", ",", "Start"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"CheckPoints", ",", "nextJ"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"CheckPoints", ",", "nextI"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Jp", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ip", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"aI", "=", "2"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"SortedPoints", ",", 
         RowBox[{"CompleteJGrid", "[", " ", 
          RowBox[{
          "nextI", ",", "ConvexHull", ",", "StartDistanceJ", ",", 
           "proportionX", ",", "Start", " ", ",", "Jp", ",", "aI"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"proportionX", " ", "=", " ", "100"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"pp", "=", "1"}], ",", " ", 
         RowBox[{"pp", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"Length", "[", "IList", "]"}], "*", "2"}]}], ",", " ", 
         RowBox[{"pp", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"IDir", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"NextPointI", "[", "CoordI", "]"}], "-", 
              RowBox[{"StartPointI", "[", "CoordI", "]"}]}], ",", 
             RowBox[{
              RowBox[{"NextPointI", "[", "CoordJ", "]"}], "-", " ", 
              RowBox[{"StartPointI", "[", "CoordJ", "]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"distanceI", " ", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IDir", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{"IDir", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"tt", " ", "=", " ", "1"}], ",", " ", 
            RowBox[{"tt", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", "IList", "]"}]}], ",", " ", 
            RowBox[{"tt", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"IList", "[", 
                   RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                 "\[NotEqual]", " ", 
                 RowBox[{"StartPointI", "[", "CoordI", "]"}]}], " ", "&&", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IList", "[", 
                   RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                 "\[GreaterEqual]", " ", 
                 RowBox[{"NextPointI", "[", "CoordI", "]"}]}]}], 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"&&", "  ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                   "\[GreaterEqual]", "   ", 
                   RowBox[{"NextPointI", "[", "CoordJ", "]"}]}]}], "||", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                  "\[LessEqual]", "    ", 
                  RowBox[{"NextPointI", "[", "CoordJ", "]"}]}]}], "*)"}], ",",
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"xtemp", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NextPointI", "[", "CoordI", "]"}], "-", 
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}]}], 
                    ")"}], "+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NextPointI", "[", "CoordJ", "]"}], "-", 
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}]}], 
                    ")"}]}], "]"}], "]"}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IDir", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"IDir", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], 
                   "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xtemp", " ", "\[LessEqual]", " ", "proportionX"}],
                    " ", "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    "\[NotEqual]", " ", 
                    RowBox[{"NextPointI", "[", "CoordI", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"proportionX", " ", "=", " ", "xtemp"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"NextIDir", " ", "=", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    "-", 
                    RowBox[{"NextPointI", "[", "CoordJ", "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    "-", 
                    RowBox[{"NextPointI", "[", "CoordI", "]"}]}]}], "}"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"distanceNextPotPointI", " ", "=", " ", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"NextIDir", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"NextIDir", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    "\[NotEqual]", " ", 
                    RowBox[{"NextPointI", " ", "[", "CoordI", "]"}]}], "&&", 
                   " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    "\[NotEqual]", " ", 
                    RowBox[{"StartPointI", "[", "CoordI", "]"}]}], "  ", "&&",
                    "  ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    ")"}], "\[LessEqual]", " ", 
                    RowBox[{
                    RowBox[{"NextPointI", "[", "CoordJ", "]"}], "+", 
                    "proportionX"}]}], "&&", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    ")"}], "\[GreaterEqual]", "  ", 
                    RowBox[{
                    RowBox[{"NextPointI", "[", "CoordJ", "]"}], "-", 
                    "proportionX"}]}], "  ", "&&", " ", 
                   RowBox[{"distanceNextPotPointI", " ", "\[LessEqual]", " ", 
                    RowBox[{"distanceI", "+", "0.5"}]}]}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"aI", " ", "=", " ", 
                    RowBox[{"aI", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Test = \>\"", ",", " ", 
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"CheckPoints", ",", 
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AssociateTo", "[", 
                    RowBox[{"SortedPointsKeys", ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], ",", 
                    RowBox[{"NeighbourJ", " ", "\[Rule]", "1"}], ",", 
                    RowBox[{"NeighbourI", "\[Rule]", " ", "aI"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"SortedPoints", ",", "SortedPointsKeys"}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"Jp", "=", 
                    RowBox[{"Jp", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"SortedPoints", ",", 
                    RowBox[{"CompleteJGrid", "[", 
                    RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], ",", "ConvexHull", ",", 
                    "StartDistanceJ", ",", "StartProportionJ", ",", "Start", 
                    ",", "Jp", " ", ",", "aI"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<StartPointI = \>\"", ",", " ", 
                    RowBox[{"StartPointI", "  ", "\"\< ; \>\""}], ",", " ", 
                    "\"\< NextPointI = \>\"", ",", " ", "NextPointI"}], "]"}],
                     ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"StartPointI", " ", "=", " ", "NextPointI"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"NextPointI", "=", 
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<NEW StartPointI = \>\"", ",", " ", 
                    RowBox[{"StartPointI", "  ", "\"\< ; \>\""}], ",", " ", 
                    "\"\< NEW NextPointI = \>\"", ",", " ", "NextPointI"}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", "\"\<SPLIT\>\"", "]"}], ";"}], 
                  "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"aJ", " ", "=", " ", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"proportionY", " ", "=", " ", "100"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"pp", "=", "1"}], ",", " ", 
         RowBox[{"pp", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "JList", "]"}]}], ",", " ", 
         RowBox[{"pp", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"JDir", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"NextPointJ", "[", "CoordJ", "]"}], "-", 
              RowBox[{"StartPointJ", "[", "CoordJ", "]"}]}], ",", 
             RowBox[{
              RowBox[{"NextPointJ", "[", "CoordI", "]"}], "-", " ", 
              RowBox[{"StartPointJ", "[", "CoordI", "]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"distanceJ", " ", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"JDir", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{"JDir", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"tt", " ", "=", " ", "1"}], ",", " ", 
            RowBox[{"tt", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", "JList", "]"}]}], ",", " ", 
            RowBox[{"tt", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                  "\[NotEqual]", " ", 
                  RowBox[{"StartPointJ", "[", "CoordJ", "]"}]}], " ", "&&", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                  "\[GreaterEqual]", " ", 
                  RowBox[{"NextPointJ", "[", "CoordJ", "]"}]}], "&&", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                  "\[GreaterEqual]", "   ", 
                  RowBox[{"NextPointJ", "[", "CoordI", "]"}]}]}], " ", "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{"JList", "[", 
                   RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                 "\[LessEqual]", "    ", 
                 RowBox[{"NextPointJ", "[", "CoordI", "]"}]}]}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ytemp", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NextPointJ", "[", "CoordJ", "]"}], "-", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}]}], 
                    ")"}], "+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NextPointJ", "[", "CoordI", "]"}], "-", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}]}], 
                    ")"}]}], "]"}], "]"}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"JDir", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"JDir", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], 
                   "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ytemp", " ", "\[LessEqual]", " ", "proportionY"}],
                    " ", "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    "\[NotEqual]", " ", 
                    RowBox[{"NextPointJ", "[", "CoordJ", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"proportionY", " ", "=", " ", "ytemp"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"NextJDir", " ", "=", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    "-", 
                    RowBox[{"NextPointJ", "[", "CoordJ", "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    "-", 
                    RowBox[{"NextPointJ", "[", "CoordI", "]"}]}]}], "}"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"distanceNextPotPointJ", " ", "=", " ", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"NextJDir", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"NextJDir", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    "\[NotEqual]", " ", 
                    RowBox[{"NextPointJ", "[", "CoordJ", "]"}]}], " ", "&&", 
                   " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordJ", "]"}], 
                    "\[NotEqual]", " ", 
                    RowBox[{"StartPointJ", "[", "CoordJ", "]"}]}], "  ", "&&", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    ")"}], "\[LessEqual]", " ", 
                    RowBox[{
                    RowBox[{"NextPointJ", "[", "CoordI", "]"}], "+", " ", 
                    "proportionY"}]}], "  ", "&&", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CoordI", "]"}], 
                    ")"}], "\[GreaterEqual]", "  ", 
                    RowBox[{
                    RowBox[{"NextPointJ", "[", "CoordI", "]"}], "-", 
                    "proportionY"}]}], "  ", "&&", " ", 
                   RowBox[{"distanceNextPotPointJ", " ", "\[LessEqual]", " ", 
                    RowBox[{"distanceJ", "+", "0.5"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"CompleteIGrid", "[", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], ",", "ConvexHull"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"StartPointJ", " ", "=", " ", "NextPointJ"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"NextPointJ", "=", 
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"aJ", "=", " ", 
                    RowBox[{"aJ", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"AssociateTo", "[", 
                    RowBox[{"SortedPointsKeys", ",", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], ",", 
                    RowBox[{"NeighbourJ", " ", "\[Rule]", "aJ"}], ",", 
                    RowBox[{"NeighbourI", "\[Rule]", " ", "1"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"SortedPoints", ",", "SortedPointsKeys"}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"CheckCellForJ", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"JList", "[", 
                    RowBox[{"[", "tt", "]"}], "]"}], "[", "CellI", "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"CheckPointJ", "=", "NextPointJ"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AssociateTo", "[", " ", 
                    RowBox[{"CheckPointJ", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NeighbourJ", " ", "\[Rule]", "aJ"}], ",", 
                    RowBox[{"NeighbourI", "\[Rule]", " ", "1"}]}], "}"}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nn", "=", 
        RowBox[{"CheckPointJ", "[", "NeighbourJ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"count", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", " ", 
         RowBox[{"ii", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "ConvexHull", "]"}]}], ",", " ", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ConvexHull", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], "[", "CellI", "]"}], 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"CheckPointJ", "[", "CellI", "]"}], "+", "1"}]}], " ", 
             "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"ConvexHull", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], "[", "CellJ", "]"}], 
              "\[GreaterEqual]", " ", 
              RowBox[{"CheckPointJ", "[", "CellJ", "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"SaftyList", ",", 
               RowBox[{"ConvexHull", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "CheckCellForJ", " ", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "SaftyList", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"uu", "=", "1"}], ",", 
         RowBox[{"uu", "\[LessEqual]", "  ", 
          RowBox[{"Length", "[", "SaftyList", "]"}]}], ",", " ", 
         RowBox[{"uu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SaftyList", "[", 
                RowBox[{"[", "uu", "]"}], "]"}], "[", "CoordJ", "]"}], 
              "\[NotEqual]", " ", 
              RowBox[{"CheckPointJ", "[", "CoordJ", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"SaftyList", "[", 
                RowBox[{"[", "uu", "]"}], "]"}], "[", "CoordJ", "]"}], 
              "\[NotEqual]", " ", 
              RowBox[{"StartPointJ", "[", "CoordJ", "]"}]}], "   ", "&&", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"SaftyList", "[", 
                 RowBox[{"[", "uu", "]"}], "]"}], "[", "CoordJ", "]"}], ")"}],
               "\[GreaterEqual]", "  ", 
              RowBox[{"CheckPointJ", "[", "CoordJ", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"SaftyList", "[", 
                 RowBox[{"[", "uu", "]"}], "]"}], "[", "CoordI", "]"}], ")"}],
               "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"CheckPointJ", "[", "CoordI", "]"}], "+", " ", 
               "proportionY"}]}], "  ", "&&", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"SaftyList", "[", 
                 RowBox[{"[", "uu", "]"}], "]"}], "[", "CoordI", "]"}], ")"}],
               "\[GreaterEqual]", "  ", 
              RowBox[{
               RowBox[{"CheckPointJ", "[", "CoordI", "]"}], "-", 
               "proportionY"}]}], "  ", "&&", " ", 
             RowBox[{"distanceNextPotPointJ", " ", "\[LessEqual]", " ", 
              RowBox[{"distanceJ", "+", "0.5"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<SaftyListPoint = \>\"", ",", 
               RowBox[{"SaftyList", "[", 
                RowBox[{"[", "uu", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"SortedPointsKeys", ",", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"SaftyList", "[", 
                  RowBox[{"[", "uu", "]"}], "]"}], ",", 
                 RowBox[{"NeighbourJ", " ", "\[Rule]", " ", 
                  RowBox[{"nn", " ", "+", "1"}]}], ",", 
                 RowBox[{"NeighbourI", "\[Rule]", "1"}]}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"SortedPoints", ",", "SortedPointsKeys"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CheckPointJ", " ", "=", 
              RowBox[{"SaftyList", "[", 
               RowBox[{"[", "uu", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"nn", "=", 
              RowBox[{"nn", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<\n\nEnd and \
Result______________________________________________________________ \n\n\
\>\"", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<SortedPoints = \>\"", ",", "SortedPoints"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "SaftyList", "]"}], ";"}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Clear", "[", "CheckPoints", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CompleteJGrid", "[", 
     RowBox[{
     "StartPointGridJ_", ",", "ConvexHull_", ",", "StartDistanceJ_", ",", 
      "proportion_", ",", "Start_", ",", "J_", ",", "aI_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PossiblePointsListJ", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"SortedPointsKeys", "=", 
         RowBox[{"<|", "|>"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<StartPointGridJ = \>\"", ",", " ", "StartPointGridJ"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"aa", "=", " ", "1"}], ",", " ", 
         RowBox[{"aa", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "ConvexHull", "]"}]}], ",", " ", 
         RowBox[{"aa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ConvexHull", "[", 
                RowBox[{"[", "aa", "]"}], "]"}], "[", "CellI", "]"}], 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"StartPointGridJ", "[", "CellI", "]"}], " ", "+", 
               "1"}]}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"ConvexHull", "[", 
                RowBox[{"[", "aa", "]"}], "]"}], "[", "CellI", "]"}], 
              "\[Equal]", " ", 
              RowBox[{
               RowBox[{"StartPointGridJ", "[", "CellI", "]"}], "-", "1"}]}], 
             " ", "||", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ConvexHull", "[", 
                 RowBox[{"[", "aa", "]"}], "]"}], "[", "CellI", "]"}], 
               "\[Equal]", " ", 
               RowBox[{"StartPointGridJ", "[", "CellI", "]"}]}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{
                RowBox[{"ConvexHull", "[", 
                 RowBox[{"[", "aa", "]"}], "]"}], "[", "CellJ", "]"}], 
               "\[LessEqual]", "  ", "splits"}]}]}], " ", 
            RowBox[{"(*", 
             RowBox[{"&&", " ", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"CheckPoints", ",", 
                 RowBox[{"ConvexHull", "[", 
                  RowBox[{"[", "aa", "]"}], "]"}]}], "]"}], "\[Equal]", 
               "False"}]}], "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"PossiblePointsListJ", ",", 
               RowBox[{"ConvexHull", "[", 
                RowBox[{"[", "aa", "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "PossiblePointsListJ", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"pp", "=", "1"}], ",", " ", 
         RowBox[{"pp", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "PossiblePointsListJ", "]"}]}], ",", " ", 
         RowBox[{"pp", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NextJGridDir", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"PossiblePointsListJ", "[", 
                RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordI", "]"}], "-", 
              RowBox[{"StartPointGridJ", "[", "CoordI", "]"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"PossiblePointsListJ", "[", 
                RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordJ", "]"}], "-", 
              RowBox[{"StartPointGridJ", "[", "CoordJ", "]"}]}]}], "}"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"distanceNextPotGridPointJ", " ", "=", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"NextJGridDir", " ", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{"NextJGridDir", " ", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"PossiblePointsListJ", "[", 
                RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordJ", "]"}], 
              "\[NotEqual]", " ", 
              RowBox[{"StartPointGridJ", "[", "CoordJ", "]"}]}], "  ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{"PossiblePointsListJ", "[", 
                RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordJ", "]"}], 
              "\[NotEqual]", " ", 
              RowBox[{"Start", "[", "CoordJ", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PossiblePointsListJ", "[", 
                 RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordI", "]"}], ")"}],
               "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"StartPointGridJ", "[", "CoordI", "]"}], "+", 
               "proportion"}]}], "&&", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PossiblePointsListJ", "[", 
                 RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordI", "]"}], ")"}],
               "\[GreaterEqual]", " ", 
              RowBox[{
               RowBox[{"StartPointGridJ", "[", "CoordI", "]"}], "-", 
               "proportion"}]}], "&&", " ", 
             RowBox[{"distanceNextPotGridPointJ", "  ", "\[LessEqual]", " ", 
              RowBox[{"StartDistanceJ", "+", "0.5"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"CheckPoints", ",", 
                RowBox[{"PossiblePointsListJ", "[", 
                 RowBox[{"[", "pp", "]"}], "]"}]}], "]"}], "\[Equal]", 
              "False"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<[PossiblePointsListJ[[pp]]]; = \>\"", ",", 
               RowBox[{"PossiblePointsListJ", "[", 
                RowBox[{"[", "pp", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"CheckPoints", ",", 
               RowBox[{"PossiblePointsListJ", "[", 
                RowBox[{"[", "pp", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<CheckPoints\>\"", ",", "CheckPoints"}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"SortedPointsKeys", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PossiblePointsListJ", "[", 
                  RowBox[{"[", "pp", "]"}], "]"}], ",", 
                 RowBox[{"NeighbourJ", " ", "\[Rule]", "J"}], ",", 
                 RowBox[{"NeighbourI", "\[Rule]", " ", "aI"}]}], "}"}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "PossiblePointsListJ", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<NEXT\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "SortedPointsKeys", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CompleteIGrid", "[", 
     RowBox[{"StartPointI_", ",", "ConvexHull_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"PossiblePointsList", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<StartPoitI = \>\"", ",", "StartPointI"}], "]"}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"distanceJ", "=", " ", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"Start", "[", "CoordJ", "]"}], "-", 
       RowBox[{"NextPointJ", "[", "CoordJ", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"aI", "=", "2"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"tt", "=", "1"}], ",", 
      RowBox[{"tt", "\[LessEqual]", " ", 
       RowBox[{"Length", "[", "IList", "]"}]}], ",", " ", 
      RowBox[{"tt", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"distanceI", " ", "=", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"StartPointI", "[", "CoordI", "]"}], "-", 
          RowBox[{"NextPointI", "[", "CoordI", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RangeI", " ", "=", "  ", 
        RowBox[{"distanceI", "+", "0.3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RangeJ", " ", "=", "  ", 
        RowBox[{"distanceJ", "+", "0.3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<RangeI = \>\"", ",", " ", "RangeI"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<distanceJ/2 = \>\"", ",", " ", 
           RowBox[{"distanceJ", "/", "2"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"pp", "=", "1"}], ",", 
         RowBox[{"pp", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "IList", "]"}]}], ",", " ", 
         RowBox[{"pp", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"IList", "[", 
               RowBox[{"[", "pp", "]"}], "]"}], "\[NotEqual]", " ", 
              "StartPointI"}], "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"IList", "[", 
                RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordI", "]"}], 
              "\[GreaterEqual]", " ", 
              RowBox[{"NextPointI", "[", "CoordI", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"NextPointI", "[", "CoordI", "]"}], "-", 
                RowBox[{
                 RowBox[{"IList", "[", 
                  RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordI", "]"}]}], 
               "]"}], "\[LessEqual]", " ", "RangeI"}]}], " ", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"IList", "[", 
                RowBox[{"[", "pp", "]"}], "]"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"IList", "[", 
                   RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordI", "]"}], 
                 "\[NotEqual]", " ", 
                 RowBox[{"NextPointI", "[", "CoordI", "]"}]}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"NextPointI", "[", "CoordJ", "]"}], "-", 
                   RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "pp", "]"}], "]"}], "[", "CoordJ", "]"}]}], 
                  "]"}], "\[LessEqual]", "  ", 
                 RowBox[{"distanceJ", "/", "2"}]}]}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"aI", "=", 
                 RowBox[{"aI", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AssociateTo", "[", 
                 RowBox[{"SortedPointsKeys", ",", 
                  RowBox[{"{", " ", 
                   RowBox[{
                    RowBox[{"IList", "[", 
                    RowBox[{"[", "pp", "]"}], "]"}], ",", 
                    RowBox[{"NeighbourJ", " ", "\[Rule]", "1"}], ",", 
                    RowBox[{"NeighbourI", "\[Rule]", " ", "aI"}]}], "}"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"SortedPoints", ",", "SortedPointsKeys"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"StartPointI", " ", "=", " ", "NextPointI"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"NextPointI", "=", 
                 RowBox[{"IList", "[", 
                  RowBox[{"[", "pp", "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<new StartPointI = \>\"", ",", "StartPointI"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<new NextPointI = \>\"", ",", "NextPointI"}], 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<SortedPoints = \>\"", ",", "SortedPoints"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7264811532375135`*^9, 3.726481358032544*^9}, {
   3.7264815405235996`*^9, 3.726481591312646*^9}, {3.726481645938631*^9, 
   3.7264817502526903`*^9}, {3.726481806084712*^9, 3.726481896796706*^9}, {
   3.726482008760741*^9, 3.72648203703578*^9}, {3.7264820734207816`*^9, 
   3.726482101770768*^9}, {3.726482132584777*^9, 3.726482135635809*^9}, {
   3.7264821765167904`*^9, 3.726482204151799*^9}, {3.7264822918696566`*^9, 
   3.726482373928073*^9}, {3.7264824928820972`*^9, 3.726482508610135*^9}, {
   3.726482701348811*^9, 3.726482711091813*^9}, {3.726482801459841*^9, 
   3.72648283572485*^9}, {3.7264828661108594`*^9, 3.72648286928786*^9}, {
   3.726482906659902*^9, 3.7264829424778824`*^9}, {3.7264829728568926`*^9, 
   3.726482973023924*^9}, {3.726483019445939*^9, 3.726483020871937*^9}, {
   3.726483073588922*^9, 3.7264830752349224`*^9}, {3.726483168490647*^9, 
   3.7264831978715625`*^9}, {3.726483499472687*^9, 3.7264835016578913`*^9}, {
   3.7264836222136664`*^9, 3.7264836251152945`*^9}, {3.7264837700475874`*^9, 
   3.7264837945403957`*^9}, {3.7264839255726357`*^9, 
   3.7264839425552955`*^9}, {3.7264843122027264`*^9, 3.726484315880494*^9}, {
   3.7264844765161543`*^9, 3.726484615597828*^9}, {3.726484670430128*^9, 
   3.726484677762367*^9}, {3.726484741583993*^9, 3.726484767308568*^9}, {
   3.7264848262044144`*^9, 3.726484837660844*^9}, {3.7264848938649936`*^9, 
   3.726484918994184*^9}, {3.726485046261489*^9, 3.726485062090596*^9}, {
   3.726485154472016*^9, 3.7264852026231775`*^9}, {3.7264853769067273`*^9, 
   3.726485419146821*^9}, {3.7264854783176203`*^9, 3.7264855069376802`*^9}, {
   3.7264855840888357`*^9, 3.726485598460046*^9}, {3.7264857344162765`*^9, 
   3.7264857620341043`*^9}, {3.7264858186661177`*^9, 
   3.7264859184197936`*^9}, {3.7264859941495156`*^9, 
   3.7264859963494587`*^9}, {3.726487045598942*^9, 3.7264870770261655`*^9}, {
   3.726487148381065*^9, 3.7264871672931457`*^9}, {3.726487320477645*^9, 
   3.7264873243198996`*^9}, 3.7264874583840866`*^9, {3.726487772448884*^9, 
   3.7264877993005767`*^9}, {3.726488303693811*^9, 3.7264883236790237`*^9}, {
   3.72648835553761*^9, 3.7264883579344206`*^9}, {3.7264884383684235`*^9, 
   3.7264884575380836`*^9}, {3.726488504198292*^9, 3.726488504989749*^9}, {
   3.7264886382068043`*^9, 3.7264886421256285`*^9}, {3.7264889336687202`*^9, 
   3.7264889480444727`*^9}, 3.726489138476057*^9, {3.726489935752432*^9, 
   3.7264899373891397`*^9}, {3.726490267631452*^9, 3.726490279860478*^9}, {
   3.726546182862161*^9, 3.7265461920781937`*^9}, {3.7265462250482025`*^9, 
   3.726546226919203*^9}, {3.7265464026379585`*^9, 3.726546404269929*^9}, {
   3.7265464642759733`*^9, 3.7265464671759777`*^9}, {3.726546519102995*^9, 
   3.7265465220699987`*^9}, {3.7265466969057336`*^9, 
   3.7265466996417265`*^9}, {3.7265467328607373`*^9, 3.726546734597737*^9}, {
   3.7265468066997595`*^9, 3.7265468206317644`*^9}, {3.7265468829097843`*^9, 
   3.7265469124307933`*^9}, {3.7265469835902424`*^9, 3.726547013326251*^9}, {
   3.726548805547038*^9, 3.7265488707020607`*^9}, 3.7265489079831066`*^9, {
   3.726548999533244*^9, 3.7265490029152484`*^9}, {3.7265490583846254`*^9, 
   3.7265490902066374`*^9}, {3.7265491757676597`*^9, 
   3.7265492471506824`*^9}, {3.7265492979396667`*^9, 3.726549321460703*^9}, {
   3.7265493894497166`*^9, 3.7265494275627365`*^9}, {3.7265494653218503`*^9, 
   3.7265495547753935`*^9}, {3.7265496002824078`*^9, 
   3.7265496050544157`*^9}, {3.726549721262447*^9, 3.726549775697727*^9}, {
   3.726549897398733*^9, 3.726549929648378*^9}, {3.726549997496399*^9, 
   3.7265500161984034`*^9}, {3.7265500606274214`*^9, 3.726550286813443*^9}, {
   3.7265503310914574`*^9, 3.726550347499463*^9}, {3.726550378029477*^9, 
   3.7265504393324904`*^9}, {3.7265505119815164`*^9, 
   3.7265505189844847`*^9}, {3.726550550879525*^9, 3.726550554038525*^9}, {
   3.7265505938535376`*^9, 3.726550595484539*^9}, {3.7265506291885448`*^9, 
   3.7265506660125628`*^9}, {3.726550700787568*^9, 3.7265507256665764`*^9}, {
   3.726550794533598*^9, 3.726550831053608*^9}, {3.726550890425624*^9, 
   3.726550892612627*^9}, 3.7265509498370657`*^9, {3.726551015858241*^9, 
   3.726551056117257*^9}, {3.726551089145485*^9, 3.726551105947469*^9}, {
   3.726551150944502*^9, 3.7265511560875072`*^9}, {3.726551267237521*^9, 
   3.726551287645542*^9}, {3.726551384281571*^9, 3.7265513879115696`*^9}, {
   3.726551495735079*^9, 3.7265515251690884`*^9}, {3.726551582160331*^9, 
   3.7265516070303392`*^9}, {3.7265516445503454`*^9, 
   3.7265516953593597`*^9}, {3.7265517284642353`*^9, 
   3.7265517316982365`*^9}, {3.7265517707402735`*^9, 
   3.7265517735352745`*^9}, {3.7265519261757*^9, 3.726551939092705*^9}, {
   3.726551996329399*^9, 3.7265520716873913`*^9}, {3.7265521169704046`*^9, 
   3.7265521691014533`*^9}, {3.726552214907347*^9, 3.726552216052357*^9}, {
   3.7265522704625783`*^9, 3.7265522731105785`*^9}, {3.7265523472170954`*^9, 
   3.7265523501971025`*^9}, {3.7265524175634394`*^9, 3.726552421586448*^9}, {
   3.726552459176452*^9, 3.726552461316744*^9}, {3.7265525103367877`*^9, 
   3.7265525146777925`*^9}, {3.7265526162658587`*^9, 3.726552616577859*^9}, {
   3.726552661869893*^9, 3.726552688428871*^9}, {3.7265527192509046`*^9, 
   3.7265528299459486`*^9}, {3.726552938757151*^9, 3.726552940990117*^9}, {
   3.7265533955143127`*^9, 3.726553395735284*^9}, {3.7265540422959213`*^9, 
   3.726554099492937*^9}, {3.7265541508089523`*^9, 3.7265542520469947`*^9}, {
   3.7265543114619827`*^9, 3.7265543650780287`*^9}, {3.7265545568590856`*^9, 
   3.726554883327546*^9}, {3.7265549357175612`*^9, 3.726555023862588*^9}, {
   3.7265556081697655`*^9, 3.7265556096057644`*^9}, {3.726555909731855*^9, 
   3.7265560319418926`*^9}, {3.7265560646429014`*^9, 
   3.7265560771179056`*^9}, {3.72655612805792*^9, 3.726556152083928*^9}, 
   3.726556200264943*^9, {3.726556284897968*^9, 3.726556329695982*^9}, {
   3.7265563620333614`*^9, 3.726556372143332*^9}, {3.726556418938346*^9, 
   3.7265564251993475`*^9}, {3.7265565444611588`*^9, 3.72655654634016*^9}, {
   3.7265565958331766`*^9, 3.7265566189991817`*^9}, {3.726557182364732*^9, 
   3.7265573964636292`*^9}, {3.7265576047130237`*^9, 3.726557650699066*^9}, {
   3.726557845063445*^9, 3.7265578857484865`*^9}, {3.72655807040987*^9, 
   3.726558078108389*^9}, {3.726558717538939*^9, 3.726558743161953*^9}, {
   3.7265588097239733`*^9, 3.726558846635986*^9}, {3.7265623966599045`*^9, 
   3.7265624036029096`*^9}, {3.726562434673918*^9, 3.7265624696748962`*^9}, 
   3.726562513291893*^9, {3.726562602383114*^9, 3.7265626328420916`*^9}, 
   3.726562670497382*^9, {3.726562725865616*^9, 3.726562736621619*^9}, {
   3.7265628681046734`*^9, 3.726562868560644*^9}, {3.7265629129796824`*^9, 
   3.726562920763687*^9}, {3.7265635830324306`*^9, 3.7265636251754355`*^9}, 
   3.7265636665264463`*^9, {3.7265651033444233`*^9, 3.726565134267471*^9}, {
   3.7265652622373223`*^9, 3.7265653107203364`*^9}, {3.726565550096476*^9, 
   3.726565552927473*^9}, {3.726565602592491*^9, 3.726565628402502*^9}, {
   3.7265656767205143`*^9, 3.7265656814035163`*^9}, {3.7265657378555355`*^9, 
   3.7265657434675045`*^9}, {3.726565862273541*^9, 3.72656591529883*^9}, {
   3.726566241758432*^9, 3.726566288412448*^9}, {3.7265666658582687`*^9, 
   3.726566669049271*^9}, {3.72656683389532*^9, 3.7265668731363316`*^9}, {
   3.726566908445341*^9, 3.7265669107653437`*^9}, {3.726567122278039*^9, 
   3.72656712249407*^9}, {3.7265686076092196`*^9, 3.726568610824252*^9}, 
   3.7265686769251647`*^9, {3.726568725691184*^9, 3.726568747458192*^9}, {
   3.726568780693201*^9, 3.726568783619171*^9}, {3.726568961788122*^9, 
   3.726568977283127*^9}, {3.726569009025135*^9, 3.726569009205138*^9}, {
   3.7265690624671373`*^9, 3.726569063154153*^9}, {3.726569109300166*^9, 
   3.726569112635167*^9}, {3.7265691850603666`*^9, 3.7265692350093784`*^9}, {
   3.72656947339036*^9, 3.726569536390415*^9}, {3.726569589934428*^9, 
   3.7265697596274757`*^9}, {3.7265698024874897`*^9, 
   3.7265698056614604`*^9}, {3.72656985558251*^9, 
   3.7265699152286716`*^9}},ExpressionUUID->"b104a4cb-26c9-457a-807a-\
82b5fbf924ee"]
},
WindowSize->{981, 988},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 57863, 1228, 5765, "Input", "ExpressionUUID" -> \
"b104a4cb-26c9-457a-807a-82b5fbf924ee"]
}
]
*)

