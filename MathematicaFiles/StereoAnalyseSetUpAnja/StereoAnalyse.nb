(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     93749,       2214]
NotebookOptionsPosition[     93443,       2200]
NotebookOutlinePosition[     93784,       2215]
CellTagsIndexPosition[     93741,       2212]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalizeCoordinates", "[", 
     RowBox[{"PC1_", ",", "PC2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CentroidPC1", ",", "CentroidPC2"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PC1 = \>\"", ",", 
          RowBox[{"MatrixForm", "[", "PC1", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PC2 = \>\"", ",", 
          RowBox[{"MatrixForm", "[", "PC2", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CentroidPC1", "=", 
        RowBox[{"Mean", "[", "PC1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CentroidPC2", "=", 
        RowBox[{"Mean", "[", "PC2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<CemtroidPC1 = \>\"", ",", 
         RowBox[{"N", "[", "CentroidPC1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<CemtroidPC2 = \>\"", ",", 
         RowBox[{"N", "[", "CentroidPC2", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"IntermediatePC1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", 
            RowBox[{"CentroidPC1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "&"}], ",", 
          RowBox[{"PC1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IntermediatePC2", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", 
            RowBox[{"CentroidPC2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "&"}], ",", 
          RowBox[{"PC2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Mean[IntermediatePC1] = \>\"", ",", " ", 
         RowBox[{"N", "[", 
          RowBox[{"Mean", "[", "IntermediatePC1", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Mean[IntermediatePC2] = \>\"", ",", 
         RowBox[{"N", "[", " ", 
          RowBox[{"Mean", "[", "IntermediatePC2", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DistanceVectorPC1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "-", "#"}], "&"}], ",", 
          "IntermediatePC1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DistancesPC1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "&"}], 
          ",", "DistanceVectorPC1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MeanDistPC1", " ", "=", " ", 
        RowBox[{"Mean", "[", "DistancesPC1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<MeanDistPC1 = \>\"", ",", 
         RowBox[{"N", "[", "MeanDistPC1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DistanceVectorPC2", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "-", "#"}], "&"}], ",", 
          "IntermediatePC2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DistancesPC2", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "&"}], 
          ",", "DistanceVectorPC2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MeanDistPC2", " ", "=", " ", 
        RowBox[{"Mean", "[", "DistancesPC2", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<MeanDistPC2 = \>\"", ",", 
         RowBox[{"N", "[", "MeanDistPC2", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"T", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC1"}], ",", "0", 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC1"}], ")"}], 
             "*", 
             RowBox[{"-", 
              RowBox[{"CentroidPC1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC1"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC1"}], ")"}], 
             "*", 
             RowBox[{"-", 
              RowBox[{"CentroidPC1", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "T", "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PC1Norm", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"T", ".", "#"}], "&"}], ",", "PC1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PC1Norm", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
          "PC1Norm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Matrix normalization PC1= \>\"", ",", 
         RowBox[{"N", "[", "PC1Norm", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"N", "[", 
         RowBox[{"Mean", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", "PC1Norm"}], "]"}], 
          "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"TPrime", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC2"}], ",", "0", 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC2"}], ")"}], 
             "*", 
             RowBox[{"-", 
              RowBox[{"CentroidPC2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "/", "MeanDistPC2"}], ")"}], 
             "*", 
             RowBox[{"-", 
              RowBox[{"CentroidPC2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "TPrime", "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PC2Norm", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TPrime", ".", "#"}], "&"}], ",", "PC2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PC2Norm", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
          "PC2Norm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Matrix normalization PC2 = \>\"", ",", 
         RowBox[{"N", "[", "PC2Norm", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"N", "[", 
         RowBox[{"Mean", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", "PC2Norm"}], "]"}], 
          "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"FundamentalMtxBestimmung", "[", 
        RowBox[{
        "PC1", ",", "PC2", ",", "PC1Norm", ",", "PC2Norm", ",", "T", ",", 
         "TPrime"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FundamentalMtxBestimmung", "[", 
     RowBox[{
     "PC1_", ",", "PC2_", ",", "PC1Norm_", ",", "PC2Norm_", ",", "T_", ",", 
      "TPrime_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CoefficientMatx", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", "UDVErgebnis", ",", "L\[ADoubleDot]ngeV", 
        " ", ",", "FinF11", " ", ",", "FinF12", " ", ",", "FinF13", " ", ",", 
        "FinF21", " ", ",", "FinF22", " ", ",", "FinF23", " ", ",", "FinF31", 
        " ", ",", "FinF32", ",", "FinF33", ",", "FFin", " ", ",", "SVDF"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<\n\nBegin Computation of \
Fundamentalmatrix________________________________________________\n\n\n\>\"", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"qq", "=", "1"}], ",", 
         RowBox[{"qq", "\[LessEqual]", 
          RowBox[{"Length", "[", "PC1Norm", "]"}]}], ",", 
         RowBox[{"qq", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"CoefficientMatx", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"PC2Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "1"}], "]"}], "]"}], "*", 
               RowBox[{"PC1Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"PC2Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "1"}], "]"}], "]"}], "*", 
               RowBox[{"PC1Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"PC2Norm", "[", 
               RowBox[{"[", 
                RowBox[{"qq", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"PC2Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "2"}], "]"}], "]"}], "*", 
               RowBox[{"PC1Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"PC2Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "2"}], "]"}], "]"}], "*", 
               RowBox[{"PC1Norm", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"PC2Norm", "[", 
               RowBox[{"[", 
                RowBox[{"qq", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"PC1Norm", "[", 
               RowBox[{"[", 
                RowBox[{"qq", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"PC1Norm", "[", 
               RowBox[{"[", 
                RowBox[{"qq", ",", "2"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<CoefficientMtx = \>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"N", "[", "CoefficientMatx", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"UDVErgebnis", " ", "=", " ", 
        RowBox[{"SingularValueDecomposition", "[", 
         RowBox[{"N", "[", "CoefficientMatx", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Rank CoefficientMatx = \>\"", ",", 
         RowBox[{"MatrixRank", "[", "CoefficientMatx", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"UDVErgebnis", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"L\[ADoubleDot]ngeV", " ", "=", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "L\[ADoubleDot]ngeV", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"FinF11", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF12", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF13", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF21", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF22", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "5", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF23", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "6", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF31", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "7", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF32", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "8", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FinF33", " ", "=", " ", 
        RowBox[{"UDVErgebnis", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "9", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FFin", " ", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"FinF11", ",", " ", "FinF12", ",", " ", "FinF13"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"FinF21", ",", "FinF22", ",", "FinF23"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"FinF31", ",", "FinF32", ",", "FinF33"}], "}"}]}], "}"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<FFin = \>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"N", "[", 
           RowBox[{"Chop", "[", "FFin", "]"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<FFin Rank = \>\"", ",", 
         RowBox[{"MatrixRank", "[", "FFin", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PC2NormTest", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",", 
          "PC2Norm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PC1NormTest", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",", 
          "PC1Norm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PC2NormTest = \>\"", ",", " ", 
         RowBox[{"N", "[", "PC2NormTest", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PC1NormTest = \>\"", ",", " ", 
         RowBox[{"N", "[", "PC1NormTest", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lPrime", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"l", ",", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FFin", ".", "#"}], "&"}], ",", "PC2NormTest"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"lPrime", ",", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "FFin", "]"}], ".", "#"}], "&"}], ",", 
           "PC1NormTest"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<l = \>\"", ",", "l"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<lPrime = \>\"", ",", "lPrime"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"l", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "50"}], ",", 
                RowBox[{"-", "30"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "5"}], ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"lPrime", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "18"}], ",", 
                RowBox[{"-", "14"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"l", ".", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "20"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lPrime", ".", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "10"}], ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SVDF", "=", 
        RowBox[{"SingularValueDecomposition", "[", "FFin", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SVDF", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"SVDF", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"SVDF", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FPrime", "=", " ", 
        RowBox[{
         RowBox[{"SVDF", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ".", 
         RowBox[{"SVDF", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ".", 
         RowBox[{"Transpose", "[", 
          RowBox[{"SVDF", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<FPrime MatrixRank = \>\"", ",", " ", 
         RowBox[{"MatrixRank", "[", "FPrime", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<FPrime = \>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", "FPrime", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MatrixRank", "[", "FPrime", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lRank2", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lPrimeRank2", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"lRank2", ",", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FPrime", ".", "#"}], "&"}], ",", "PC2NormTest"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"lPrimeRank2", ",", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "FPrime", "]"}], ".", "#"}], "&"}], 
           ",", "PC1NormTest"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<lRank2 = \>\"", ",", "lRank2"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<lPrime = \>\"", ",", "lPrimeRank2"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"lRank2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "50"}], ",", 
                RowBox[{"-", "30"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "5"}], ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"lPrimeRank2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "18"}], ",", 
                RowBox[{"-", "14"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lRank2", ".", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "20"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lPrimeRank2", ".", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "20"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Denormalize", " ", "F"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"F", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "TPrime", "]"}], ".", "FPrime", ".", 
         "T"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Demnormalized FPrime -> F =\>\"", ",", 
         RowBox[{"MatrixForm", "[", "F", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<F Rank = \>\"", ",", 
         RowBox[{"MatrixRank", "[", "F", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"tt", "=", "1"}], ",", 
         RowBox[{"tt", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "PC1", "]"}]}], ",", 
         RowBox[{"tt", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"PC2", "[", 
              RowBox[{"[", "tt", "]"}], "]"}], ".", "F", ".", 
             RowBox[{"PC1", "[", 
              RowBox[{"[", "tt", "]"}], "]"}]}], "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lRank2De", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lPrimeRank2De", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"lRank2De", ",", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", ".", "#"}], "&"}], ",", "PC2"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"lPrimeRank2De", ",", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "F", "]"}], ".", "#"}], "&"}], ",", 
           "PC1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<lRank2De = \>\"", ",", "lRank2De"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<lPrimeRank2De = \>\"", ",", "lPrimeRank2De"}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"lRank2De", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "14218"}], ",", 
                RowBox[{"-", "14215"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "63", ",", "63.5"}], "}"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"lPrimeRank2De", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "6300"}], ",", 
                RowBox[{"-", "6200"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "419", ",", "422"}], "}"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lRank2De", ".", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "1930"}], ",", 
              RowBox[{"-", "1900"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "968", ",", "971"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lPrimeRank2De", ".", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "1"}], "}"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "1650"}], ",", 
              RowBox[{"-", "1600"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "750", ",", "800"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"epipole", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"NullSpace", "[", "F", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"epipolePrime", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"NullSpace", "[", 
          RowBox[{"Transpose", "[", "F", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testEpipolPrime", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "F", "]"}], ".", "epipolePrime"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testEpipol", "=", 
        RowBox[{"F", ".", "epipole"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<epipole =\>\"", ",", 
         RowBox[{"Chop", "[", "epipole", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<epipolePrime = \>\"", ",", 
         RowBox[{"Chop", "[", "epipolePrime", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Test F^T.e' = \>\"", ",", 
         RowBox[{"Chop", "[", "testEpipolPrime", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Test F.e = \>\"", ",", 
         RowBox[{"Chop", "[", "testEpipol", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<\n\nEnd Computation of \
Fundamentalmatrix________________________________________________\n\n\n\>\"", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"EssentialMtxAlgorithm", "[", 
          RowBox[{
          "F", ",", "PC1Norm", ",", "PC2Norm", ",", "T", ",", "TPrime"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EssentialMtx", "[", 
        RowBox[{"F", ",", "PC1Norm", ",", "PC2Norm"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"EssentialMtxAlgorithm", "[", 
      RowBox[{
      "F_", ",", "PC1Norm_", ",", "PC2Norm_", ",", "T_", ",", "TPrime_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "normPC1", ",", " ", "normPC2", ",", "K1", ",", "K2", ",", " ", 
         "UDVErgebnis", ",", "L\[ADoubleDot]ngeV", " ", ",", "FinE11", " ", 
         ",", "FinE12", " ", ",", "FinE13", " ", ",", "FinE21", " ", ",", 
         "FinE22", " ", ",", "FinE23", " ", ",", "FinE31", " ", ",", "FinE32",
          ",", "FinE33", ",", "EFin", ",", "SVDE", ",", 
         RowBox[{"CoefficientMtx", " ", "=", " ", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<\n\nBegin Computation of Essential Matrix with \
8-Point-Algorithm____________________________\n\n\n\>\"", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"K1", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"17.3158028", ",", "0", ",", "6.146589863"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "17.31981867", ",", "4.600615527"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"K2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"18.60732121", ",", "0", ",", "4.145650968"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "18.58796099", ",", "3.22706539"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "px", " ", "to", " ", "mm", " ", "for", " ", "both", " ", 
          "imagePoints"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PC1mm", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "*", "6.5"}], ")"}], "/", "1000"}], " ", "&"}], 
             ",", "PC1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"PC2mm", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "*", "4.29"}], ")"}], "/", "1000"}], " ", "&"}], 
             ",", "PC2"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"PC1mm", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "*", "6.5"}], ")"}], "/", "1000"}], " ", "&"}], 
           ",", "PC1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PC2mm", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "*", "4.29"}], ")"}], "/", "1000"}], " ", "&"}], 
           ",", "PC2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PC1mm", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], 
             ",", "PC1mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"PC2mm", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], 
             ",", "PC2mm"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PC1 in mm = \>\"", ",", " ", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"N", "[", "PC1mm", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PC2 in mm = \>\"", ",", " ", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"N", "[", "PC2mm", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"normPC1", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "K1", "]"}], ".", "#"}], "&"}], ",", 
           "PC1mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normPC2", " ", "=", "  ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "K2", "]"}], ".", "#"}], "&"}], ",", 
           "PC2mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normPC1", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",", 
           "normPC1"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normPC2", " ", "=", "  ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",", 
           "normPC2"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<normalized Coordinates K1 = \>\"", ",", " ", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"N", "[", "normPC1", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<normalized Coordinates K2 = \>\"", ",", " ", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"N", "[", "normPC2", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"qq", "=", "1"}], ",", 
          RowBox[{"qq", "\[LessEqual]", 
           RowBox[{"Length", "[", "normPC1", "]"}]}], ",", 
          RowBox[{"qq", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"CoefficientMtx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"normPC2", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "1"}], "]"}], "]"}], "*", 
                RowBox[{"normPC1", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"normPC2", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "1"}], "]"}], "]"}], "*", 
                RowBox[{"normPC1", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"normPC2", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"normPC2", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "2"}], "]"}], "]"}], "*", 
                RowBox[{"normPC1", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"normPC2", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "2"}], "]"}], "]"}], "*", 
                RowBox[{"normPC1", "[", 
                 RowBox[{"[", 
                  RowBox[{"qq", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"normPC2", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"normPC1", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"normPC1", "[", 
                RowBox[{"[", 
                 RowBox[{"qq", ",", "2"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<CoefficientMtx = \>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"N", "[", "CoefficientMtx", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UDVErgebnis", " ", "=", " ", 
         RowBox[{"SingularValueDecomposition", "[", 
          RowBox[{"N", "[", "CoefficientMtx", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Rank CoefficientMatx = \>\"", ",", 
          RowBox[{"MatrixRank", "[", "CoefficientMtx", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"UDVErgebnis", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"L\[ADoubleDot]ngeV", " ", "=", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"UDVErgebnis", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "L\[ADoubleDot]ngeV", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"FinE11", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE12", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE13", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE21", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE22", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "5", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE23", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "6", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE31", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "7", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE32", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "8", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"FinE33", " ", "=", " ", 
         RowBox[{"UDVErgebnis", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "9", ",", "L\[ADoubleDot]ngeV"}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"EFin", " ", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"FinE11", ",", " ", "FinE12", ",", " ", "FinE13"}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"FinE21", ",", "FinE22", ",", "FinE23"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"FinE31", ",", "FinE32", ",", "FinE33"}], "}"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"FFin", " ", "=", " ", 
           RowBox[{"FFin", "/", 
            RowBox[{"FFin", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<EFin = \>\"", ",", 
          RowBox[{"N", "[", 
           RowBox[{"Chop", "[", "EFin", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<EFin = \>\"", ",", 
          RowBox[{"MatrixRank", "[", "EFin", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"SVDE", "=", 
         RowBox[{"SingularValueDecomposition", "[", "EFin", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SVDE = \>\"", ",", " ", "SVDE"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SVD", "=", 
         RowBox[{"SingularValueDecomposition", "[", "EFin", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SVD of EMtx =\>\"", ",", "SVD"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SVD", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SVD", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}], "+", 
               RowBox[{"SVD", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], 
             "/", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SVD", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}], "+", 
               RowBox[{"SVD", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], 
             "/", "2"}], ",", "0"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<new SVD = \>\"", ",", "SVD"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"EPrime", "=", 
         RowBox[{
          RowBox[{"SVD", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", 
          RowBox[{"SVD", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"SVD", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<EPrime = \>\"", ",", "EPrime"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<EPrime = \>\"", ",", 
          RowBox[{"MatrixRank", "[", "EPrime", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<\n\nEnd Computation of Essential Matrix with \
8-Point-Algorithm____________________________\n\n\n\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ExtractRotationAndTranslation", "[", 
         RowBox[{"EPrime", " ", ",", "PC1", ",", "PC2"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EssentialMtx", "[", 
     RowBox[{"F_", ",", "PC1Norm_", ",", "PC2Norm_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K1", ",", "K2", ",", "EsMtx", ",", "SVD", ",", "normPC1", ",", 
        "normPC2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<\n\nBegin Computation of Essential Matrix with K1 and \
K2___________________________________\n\n\n\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"K1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"17.3158028", ",", "0", ",", "6.146589863"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "17.31981867", ",", "4.600615527"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"18.60732121", ",", "0", ",", "4.145650968"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "18.58796099", ",", "3.22706539"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PC1mm", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "*", "6.5"}], ")"}], "/", "1000"}], " ", "&"}], ",",
           "projectedPointsK1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PC2mm", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "*", "4.29"}], ")"}], "/", "1000"}], " ", "&"}], 
          ",", "projectedPointsK2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"PC1mm", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "*", "6.5"}], ")"}], "/", "1000"}], " ", "&"}], 
            ",", "PC1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PC2mm", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "*", "4.29"}], ")"}], "/", "1000"}], " ", "&"}], 
            ",", "PC2"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"qq", "=", "1"}], ",", 
         RowBox[{"qq", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "PC1mm", "]"}]}], ",", 
         RowBox[{"qq", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"PC1mm", "[", 
            RowBox[{"[", "qq", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"PC1mm", "[", 
             RowBox[{"[", "qq", "]"}], "]"}], "/", 
            RowBox[{"PC1mm", "[", 
             RowBox[{"[", 
              RowBox[{"qq", ",", "3"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PC2mm", "[", 
            RowBox[{"[", "qq", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"PC2mm", "[", 
             RowBox[{"[", "qq", "]"}], "]"}], "/", 
            RowBox[{"PC2mm", "[", 
             RowBox[{"[", 
              RowBox[{"qq", ",", "3"}], "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PC1mm = \>\"", ",", 
         RowBox[{"MatrixForm", "[", "PC1mm", " ", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PC2mm = \>\"", ",", 
         RowBox[{"MatrixForm", "[", "PC2mm", "]"}]}], " ", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"PC1mm", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",",
             "PC1mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PC2mm", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",",
             "PC2mm"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PC1 in mm = \>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"N", "[", "PC1mm", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PC2 in mm = \>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"N", "[", "PC2mm", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"normPC1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Inverse", "[", "K1", "]"}], ".", "#"}], "&"}], ",", 
          "PC1mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"normPC2", " ", "=", "  ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Inverse", "[", "K2", "]"}], ".", "#"}], "&"}], ",", 
          "PC2mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"normPC1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",", 
          "normPC1"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"normPC2", " ", "=", "  ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], "&"}], ",", 
          "normPC2"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<normalized Coordinates K1 = \>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"N", "[", "normPC1", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<normalized Coordinates K2 = \>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"N", "[", "normPC2", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"EsMtx", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "K2", "]"}], ".", "F", ".", "K1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<EsMtx = \>\"", ",", " ", "EsMtx"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MatrixRank", "[", "EsMtx", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SVD", "=", 
        RowBox[{"SingularValueDecomposition", "[", "EsMtx", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<SVD of EMtx =\>\"", ",", "SVD"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SVD", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SVD", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}], "+", 
              RowBox[{"SVD", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], "/",
             "2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SVD", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}], "+", 
              RowBox[{"SVD", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}], "/",
             "2"}], ",", "0"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<new SVD = \>\"", ",", "SVD"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"EPrime", "=", 
        RowBox[{
         RowBox[{"SVD", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ".", 
         RowBox[{"SVD", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ".", 
         RowBox[{"Transpose", "[", 
          RowBox[{"SVD", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<EPrime = \>\"", ",", "EPrime"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MatrixRank", "[", "EPrime", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"zz", "=", "1"}], ",", " ", 
         RowBox[{"zz", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "normPC1", "]"}]}], ",", " ", 
         RowBox[{"zz", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"normPC2", "[", 
             RowBox[{"[", "zz", "]"}], "]"}], ".", "EPrime", ".", 
            RowBox[{"normPC1", "[", 
             RowBox[{"[", "zz", "]"}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<\n\nEnd Computation of Essential Matrix with K1 and \
K2___________________________________\n\n\n\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ExtractRotationAndTranslation", "[", 
        RowBox[{"EsMtx", ",", "PC1", ",", "PC2"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractRotationAndTranslation", "[", 
    RowBox[{"EPrime_", ",", "PC1_", ",", "PC2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "W", ",", "Z", ",", "U", ",", "V", ",", "Sigma", ",", "S1", ",", "S2", 
       ",", "R1", ",", "R2", ",", "i", ",", "t", ",", "P21", ",", "P22", ",", 
       "P23", ",", "P24", ",", "NewE"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<\n\nBegin Reconstruction of Rotation and \
Translation________________________________________________\n\n\n\>\"", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<E = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "EPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"U", ",", "Sigma", ",", "V"}], "}"}], "=", 
       RowBox[{"SingularValueDecomposition", "[", "EPrime", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<U of E = \>\"", ",", "U"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Sigma of E = \>\"", ",", "Sigma"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<V of E = \>\"", ",", "V"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"W", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Z", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S1", "=", 
       RowBox[{"-", 
        RowBox[{"U", ".", "Z", ".", 
         RowBox[{"Transpose", "[", "U", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S2", "=", 
       RowBox[{"U", ".", "Z", ".", 
        RowBox[{"Transpose", "[", "U", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"R2", "=", 
       RowBox[{"U", ".", 
        RowBox[{"Transpose", "[", "W", "]"}], ".", 
        RowBox[{"Transpose", "[", "V", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"R1", "=", 
       RowBox[{"U", ".", "W", ".", 
        RowBox[{"Transpose", "[", "V", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<S1 = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "S1", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<S2 = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "S2", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<R1 = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "R1", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<R2 = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "R2", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Check if t of S1, S2 is equal = \>\"", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NullSpace", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"S1", ",", "S2"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"NullSpace", "[", 
           RowBox[{"Transpose", "[", "S1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<t = \>\"", ",", " ", "t"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"U", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"t", "=", " ", 
         RowBox[{"NullSpace", "[", 
          RowBox[{"Flatten", "[", "EPrime", "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<R1 is Rotation = \>\"", ",", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "R1", "]"}], ".", "R1"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<R2 is Rotation =\>\"", ",", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "R2", "]"}], ".", "R2"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Determinant of R1 = \>\"", ",", 
        RowBox[{"Det", "[", "R1", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Determinant of R2 = \>\"", ",", 
        RowBox[{"Det", "[", "R2", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Det", "[", "R1", "]"}], "\[Equal]", 
          RowBox[{"-", "1"}]}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"Det", "[", "R2", "]"}], "\[Equal]", 
          RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R1", "=", 
          RowBox[{"R1", "*", 
           RowBox[{"-", "1"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"R2", "=", 
          RowBox[{"R2", "*", 
           RowBox[{"-", "1"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LeftEprime", " ", "=", " ", 
       RowBox[{"NullSpace", "[", "EPrime", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"Flatten", "[", "LeftEprime", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LeftS2", " ", "=", 
       RowBox[{"NullSpace", "[", "S2", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Left E und S = \>\"", ",", " ", "LeftEprime", ",", " ", 
        "\"\< , \>\"", ",", " ", "LeftS2"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P1", "=", "R1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2", "=", "R1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P3", "=", "R2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P4", "=", "R2"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"P1", "=", 
         RowBox[{"U", ".", "W", ".", 
          RowBox[{"Transpose", "[", "V", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"P2", "=", 
         RowBox[{"U", ".", "W", ".", 
          RowBox[{"Transpose", "[", "V", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"P3", "=", 
         RowBox[{"U", ".", 
          RowBox[{"Transpose", "[", "W", "]"}], ".", 
          RowBox[{"Transpose", "[", "V", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"P4", "=", 
         RowBox[{"U", ".", 
          RowBox[{"Transpose", "[", "W", "]"}], ".", 
          RowBox[{"Transpose", "[", "V", "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P1", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P1", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"P2", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P2", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"P3", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P3", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"P4", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"P4", " ", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "*", 
            RowBox[{"t", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<P1 = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", "P1", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<P2 = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "P2", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<P3 = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", "P3", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<P4 = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", "P4", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IP3z", " ", "=", 
       RowBox[{"EulerAngles", "[", 
        RowBox[{"P4", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", 
           RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "IP3z", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Test", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"t", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{"t", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"t", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"t", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}], ".", 
        "R2"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"MatrixForm", "[", "Test", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<\n\nEnd Reconstruction of Rotation and \
Translation________________________________________________\n\n\n\>\"", "]"}],
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7252766264604006`*^9, 3.7252766322523565`*^9}, {
   3.72527666464916*^9, 3.7252766892638583`*^9}, {3.7252774505389767`*^9, 
   3.7252774699776506`*^9}, {3.7252775076589813`*^9, 3.725277575836811*^9}, {
   3.7252776803576984`*^9, 3.7252776805761566`*^9}, {3.725277746124158*^9, 
   3.725277840791458*^9}, {3.72527788731328*^9, 3.7252779087536635`*^9}, {
   3.7252779487994876`*^9, 3.7252780154140563`*^9}, {3.725278379306151*^9, 
   3.725278420381429*^9}, {3.725278514680869*^9, 3.725278519470109*^9}, {
   3.725278885341861*^9, 3.7252788986002483`*^9}, {3.725278939859255*^9, 
   3.7252789668372726`*^9}, {3.725279080551244*^9, 3.725279129351164*^9}, {
   3.725279238286098*^9, 3.725279246472181*^9}, {3.7252796220993576`*^9, 
   3.725279638695733*^9}, {3.7252796905063915`*^9, 3.725279711258729*^9}, 
   3.7252801666761775`*^9, {3.725280201020158*^9, 3.725280201598253*^9}, 
   3.7252802465250773`*^9, {3.725280360754158*^9, 3.7252804548229036`*^9}, {
   3.725280487051957*^9, 3.725280487349094*^9}, {3.725280666146653*^9, 
   3.7252806997758975`*^9}, {3.725280860816917*^9, 3.725280866738057*^9}, {
   3.7252808967540007`*^9, 3.7252809230835915`*^9}, {3.7252810768004875`*^9, 
   3.7252811040241776`*^9}, {3.725281155788267*^9, 3.7252811570854053`*^9}, {
   3.7252811964258156`*^9, 3.725281199447112*^9}, {3.725281240340985*^9, 
   3.7252812922218447`*^9}, {3.7252813321291924`*^9, 
   3.7252815020963163`*^9}, {3.72528171144862*^9, 3.725281905078842*^9}, {
   3.7252819519408216`*^9, 3.7252819921123476`*^9}, {3.7252820272432985`*^9, 
   3.725282042785596*^9}, {3.725282120459447*^9, 3.725282143238437*^9}, {
   3.7252822044205575`*^9, 3.72528233320754*^9}, {3.725282428397529*^9, 
   3.7252824370058527`*^9}, {3.725284401301568*^9, 3.7252845386633415`*^9}, {
   3.7252845738499784`*^9, 3.7252845816030755`*^9}, {3.725284650553776*^9, 
   3.7252846538179703`*^9}, {3.7252847182378435`*^9, 3.725284736793008*^9}, {
   3.725286150769752*^9, 3.725286159035842*^9}, {3.7252869830823593`*^9, 
   3.725286985415821*^9}, {3.7252871093413353`*^9, 3.725287112227058*^9}, {
   3.725287370774206*^9, 3.7252874119188194`*^9}, {3.725287757601882*^9, 
   3.725287761326769*^9}, {3.7252879521126294`*^9, 3.7252879545616174`*^9}, {
   3.725288341508831*^9, 3.725288355307702*^9}, {3.725288642499653*^9, 
   3.725288645400261*^9}, {3.7252886785458612`*^9, 3.725288679618233*^9}, {
   3.7252894482139664`*^9, 3.7252894567000203`*^9}, {3.7252910663061914`*^9, 
   3.725291088279887*^9}, {3.725291124914029*^9, 3.7252911270960684`*^9}, {
   3.725335833283859*^9, 3.725335836285355*^9}, {3.725336934135903*^9, 
   3.7253369602915773`*^9}, {3.7253374898205986`*^9, 
   3.7253375201778946`*^9}, {3.7253387241134005`*^9, 
   3.7253387337159038`*^9}, {3.725339298221224*^9, 3.7253395757967105`*^9}, 
   3.7253396099272785`*^9, {3.72533964171154*^9, 3.7253396673727093`*^9}, {
   3.7253397330068474`*^9, 3.725339758405675*^9}, {3.7253398233247347`*^9, 
   3.7253398336802416`*^9}, {3.7253398650471587`*^9, 
   3.7253398998438005`*^9}, {3.725339975745985*^9, 3.725339994618905*^9}, {
   3.7253400517345877`*^9, 3.725340080913067*^9}, {3.7253401842336073`*^9, 
   3.725340253184476*^9}, {3.725340293822847*^9, 3.7253404570782037`*^9}, {
   3.725341020645245*^9, 3.725341027492996*^9}, {3.725341105640753*^9, 
   3.725341106008646*^9}, {3.725341558104815*^9, 3.725341569356144*^9}, {
   3.7253416076540236`*^9, 3.7253416282116966`*^9}, {3.7253418967738795`*^9, 
   3.725341917292894*^9}, {3.725342144425728*^9, 3.7253421576194286`*^9}, {
   3.7253424494926205`*^9, 3.725342638655534*^9}, {3.725343238675639*^9, 
   3.7253432452582912`*^9}, {3.7253434023268147`*^9, 3.725343402747907*^9}, {
   3.7253436472441063`*^9, 3.7253436607145925`*^9}, {3.7253438500509806`*^9, 
   3.725343914666997*^9}, {3.7253439452320423`*^9, 3.7253439516815524`*^9}, {
   3.72534398741136*^9, 3.725344056863454*^9}, {3.725344092679476*^9, 
   3.7253440982659893`*^9}, {3.725344232134533*^9, 3.725344283627291*^9}, {
   3.725344332665637*^9, 3.72534448781312*^9}, {3.725344532995614*^9, 
   3.725344563495386*^9}, {3.7253448368806286`*^9, 3.7253448646755714`*^9}, {
   3.725344897197342*^9, 3.7253449532677574`*^9}, {3.7253450262641187`*^9, 
   3.7253450294072037`*^9}, {3.725345061875579*^9, 3.725345070014818*^9}, {
   3.725345135881686*^9, 3.725345138946125*^9}, {3.725346357180698*^9, 
   3.725346389255282*^9}, {3.7253464494305353`*^9, 3.72534645825049*^9}, {
   3.725347151915841*^9, 3.725347154345275*^9}, {3.7253527675277033`*^9, 
   3.7253527943935633`*^9}, {3.725352837896702*^9, 3.7253528381067047`*^9}, {
   3.7258606943115654`*^9, 3.725860697240632*^9}, {3.725860835016037*^9, 
   3.7258608656330414`*^9}, {3.7258609306036835`*^9, 
   3.7258609531254835`*^9}, {3.7258610284826083`*^9, 3.725861148326913*^9}, {
   3.725861760731904*^9, 3.725861897916995*^9}, {3.7258620895621924`*^9, 
   3.7258621306794367`*^9}, {3.7258622642126675`*^9, 
   3.7258622667703404`*^9}, {3.7258625814993773`*^9, 3.725862584031257*^9}, {
   3.725862723844263*^9, 3.7258627330222216`*^9}, {3.725862771578133*^9, 
   3.725862788499988*^9}, {3.7258628609982357`*^9, 3.7258628691386175`*^9}, {
   3.7258631703704023`*^9, 3.7258631918121433`*^9}, {3.7258632447517643`*^9, 
   3.725863267625185*^9}, {3.7258633149560156`*^9, 3.7258633348126717`*^9}, {
   3.7258633822512674`*^9, 3.7258633852072372`*^9}, {3.72587038323724*^9, 
   3.72587038386224*^9}, {3.725870525600139*^9, 3.7258705262215667`*^9}, {
   3.725871003541953*^9, 3.725871028409693*^9}, {3.7258711376125774`*^9, 
   3.725871215550502*^9}, {3.7258713321058455`*^9, 3.725871339285429*^9}, {
   3.7258717433626366`*^9, 3.725871750128786*^9}, {3.725872075832546*^9, 
   3.7258720849950843`*^9}, 3.725872154729804*^9, {3.7258732497242193`*^9, 
   3.7258732577420564`*^9}, {3.725873469254998*^9, 3.7258734719177885`*^9}, {
   3.7258739598022733`*^9, 3.7258739614621687`*^9}, {3.725874021036992*^9, 
   3.72587404892689*^9}, {3.725875701368163*^9, 3.725875704270452*^9}, {
   3.7258758876458964`*^9, 3.725875892747517*^9}, {3.7258763664983945`*^9, 
   3.725876368453725*^9}, {3.7258818231279993`*^9, 3.7258818280222063`*^9}, {
   3.7258818630363116`*^9, 3.7258818652886324`*^9}, {3.726212493778223*^9, 
   3.726212503663506*^9}, {3.7262923592735605`*^9, 3.7262923781895313`*^9}, {
   3.7262925088225946`*^9, 3.726292512125595*^9}, {3.7262926736656346`*^9, 
   3.726292677359606*^9}, {3.7262941040762625`*^9, 3.726294129491296*^9}, {
   3.726294227401325*^9, 3.7262943140453434`*^9}, {3.726294547831399*^9, 
   3.7262945836304097`*^9}, {3.7262946536153965`*^9, 3.726294655308397*^9}, {
   3.726297195896731*^9, 3.726297197839759*^9}, {3.7262972419267397`*^9, 
   3.7262972446127405`*^9}, {3.7262973915987763`*^9, 3.726297396552807*^9}, {
   3.7262978911200137`*^9, 3.7262979230710516`*^9}, {3.7262980343440485`*^9, 
   3.726298065727086*^9}, {3.726298124935071*^9, 3.7262983100311613`*^9}, {
   3.7262983725011764`*^9, 3.7262984197491913`*^9}, {3.726298453559166*^9, 
   3.726298462269169*^9}, {3.726298522029213*^9, 3.7262985236292133`*^9}, {
   3.726299053617313*^9, 3.7262990552563133`*^9}, {3.7262991197163296`*^9, 
   3.7262991243723307`*^9}, {3.7262992410390577`*^9, 3.72629940044013*^9}, {
   3.7262994752561502`*^9, 3.7262994756321454`*^9}, {3.726299506693155*^9, 
   3.7262995890931773`*^9}, {3.726300368024418*^9, 3.726300403472392*^9}, {
   3.726301044710228*^9, 3.726301047808199*^9}, {3.7263013140492864`*^9, 
   3.726301315747264*^9}, {3.726301558732354*^9, 3.7263015675223565`*^9}, {
   3.7263054115985146`*^9, 3.726305454260556*^9}, 3.7263058529487123`*^9, {
   3.726314608624324*^9, 3.72631461194033*^9}, {3.7263146565506325`*^9, 
   3.726314671938919*^9}, {3.7263177767886195`*^9, 3.726317784151619*^9}, {
   3.727410638615055*^9, 3.727410638751046*^9}, {3.7274106728000593`*^9, 
   3.7274107112030716`*^9}, {3.7274132593333907`*^9, 3.72741326427742*^9}, {
   3.727413345449443*^9, 3.727413415416068*^9}, {3.727413481938048*^9, 
   3.7274136116491137`*^9}, {3.7274136569120965`*^9, 3.727413657345131*^9}, {
   3.727413710297125*^9, 3.7274137435071187`*^9}, {3.7274139446921463`*^9, 
   3.7274139648861275`*^9}, {3.7274140148741713`*^9, 
   3.7274140752191873`*^9}, {3.7274141107901735`*^9, 
   3.7274141508302093`*^9}, {3.7274142006361914`*^9, 3.727414276376212*^9}, {
   3.7274143974072742`*^9, 3.727414407284279*^9}, {3.72741444332926*^9, 
   3.7274147212633643`*^9}, {3.727414774824348*^9, 3.7274148654324036`*^9}, {
   3.727414896410411*^9, 3.727415412338552*^9}, {3.72741544268353*^9, 
   3.7274157506653767`*^9}, {3.7274206774629593`*^9, 
   3.7274207053959913`*^9}, {3.727420772191759*^9, 3.7274208995187883`*^9}, {
   3.727424606715042*^9, 3.7274246382900467`*^9}, {3.727424689841061*^9, 
   3.7274246921160307`*^9}, {3.727424748285047*^9, 3.7274248851281157`*^9}, {
   3.727424923766124*^9, 3.727424936680128*^9}, 3.7274250679813614`*^9, {
   3.727425115687375*^9, 3.7274251221193743`*^9}, {3.727425167639391*^9, 
   3.7274252254248075`*^9}, {3.7274253455928454`*^9, 
   3.7274254711298447`*^9}, {3.7274255060438833`*^9, 3.727425758445952*^9}, {
   3.727425874932987*^9, 3.7274258760419874`*^9}, {3.727425938392005*^9, 
   3.727425984867014*^9}, {3.72742608112704*^9, 3.7274260858050423`*^9}, {
   3.727430261944497*^9, 3.7274302791875014`*^9}, {3.7274303282054844`*^9, 
   3.727430337148518*^9}, {3.7274303745085287`*^9, 3.7274303747195263`*^9}, 
   3.7274305426525726`*^9, {3.7274310197967057`*^9, 3.7274311362277403`*^9}, {
   3.727431203175723*^9, 3.7274312032987537`*^9}, {3.7274313233867865`*^9, 
   3.727431329298758*^9}, {3.7274313714638033`*^9, 3.727431373199769*^9}, {
   3.727431490234831*^9, 3.72743165735188*^9}, 3.727431762310876*^9, {
   3.727431817647921*^9, 3.7274318255469275`*^9}, {3.7274318911869407`*^9, 
   3.7274318918169117`*^9}, {3.727431944059925*^9, 3.727431944985956*^9}, {
   3.72743201073297*^9, 3.727432014323982*^9}, {3.727432103198003*^9, 
   3.727432104256999*^9}, {3.727432523738141*^9, 3.7274325269971447`*^9}, {
   3.7274326060631676`*^9, 3.7274327167161975`*^9}, {3.727432847141229*^9, 
   3.7274329069412456`*^9}, {3.727432938862255*^9, 3.7274329464272566`*^9}, {
   3.7274329865522676`*^9, 3.7274329887522383`*^9}, {3.7274334255119123`*^9, 
   3.7274334269438815`*^9}, {3.727433487294929*^9, 3.7274334944819*^9}, {
   3.7274335436609135`*^9, 3.72743356485892*^9}, {3.727434093376109*^9, 
   3.727434210411108*^9}, {3.7274342501011534`*^9, 3.7274342717231255`*^9}, {
   3.727434312876135*^9, 3.7274343397651453`*^9}, {3.727434371804183*^9, 
   3.7274344888352118`*^9}, {3.7274345254862275`*^9, 3.727434554326236*^9}, {
   3.727434633201256*^9, 3.7274347080352726`*^9}, {3.7274347421932893`*^9, 
   3.727434862777317*^9}, {3.7274472238287125`*^9, 3.7274472429614396`*^9}, {
   3.727447283978016*^9, 3.727447308861456*^9}, {3.7274473744030104`*^9, 
   3.727447374655535*^9}, {3.727447410799518*^9, 3.7274474399969788`*^9}, 
   3.7274485896296763`*^9, {3.7275091922642713`*^9, 3.727509196875023*^9}, {
   3.727677486975624*^9, 3.727677527353615*^9}, {3.727677578656674*^9, 
   3.7276775841680937`*^9}, {3.7277692439912186`*^9, 3.727769248338484*^9}, {
   3.7277693993367014`*^9, 3.7277694411640716`*^9}, {3.7277695311023445`*^9, 
   3.727769535218396*^9}, {3.727770119086607*^9, 3.727770173064435*^9}, {
   3.7277702397446413`*^9, 3.727770251884015*^9}, {3.7277703291263046`*^9, 
   3.727770346348663*^9}, {3.7277708203671865`*^9, 3.727770826530158*^9}, {
   3.727770860708352*^9, 3.7277708635559683`*^9}, 3.7277709203553634`*^9, {
   3.727770976751786*^9, 3.727771059801726*^9}, {3.727771091236515*^9, 
   3.7277710940679893`*^9}, {3.7277713055429*^9, 3.727771329560052*^9}, {
   3.72777140779253*^9, 3.727771412344016*^9}, {3.727771512314701*^9, 
   3.727771586730546*^9}, {3.7277716487768793`*^9, 3.727771696104519*^9}, {
   3.7277719305268764`*^9, 3.727771941095391*^9}, {3.7277722927726126`*^9, 
   3.7277722934022884`*^9}, {3.72777239657294*^9, 3.7277723993684964`*^9}, {
   3.7277728357202864`*^9, 3.7277728723235245`*^9}, {3.7277729970499535`*^9, 
   3.7277730516155024`*^9}, {3.727773167860953*^9, 3.7277732052740097`*^9}, 
   3.7277732713727045`*^9, {3.7277733075826597`*^9, 3.727773308689927*^9}, {
   3.72777338146488*^9, 3.7277733828313365`*^9}, {3.727773416851712*^9, 
   3.7277734257231054`*^9}, {3.727773591830539*^9, 3.727773594017062*^9}, {
   3.7277745013637652`*^9, 3.727774507854539*^9}, {3.727774564359848*^9, 
   3.727774586536932*^9}, {3.7277748163018656`*^9, 3.7277748166876507`*^9}, {
   3.727774859421068*^9, 
   3.7277749167113695`*^9}},ExpressionUUID->"14d72b4d-6772-4630-8484-\
59c1264927bf"]
},
WindowSize->{959, 988},
WindowMargins->{{Automatic, 4}, {Automatic, 3}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 92881, 2178, 10619, "Input", "ExpressionUUID" -> \
"14d72b4d-6772-4630-8484-59c1264927bf"]
}
]
*)

